<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>智慧旅游管理系统</title>

  <!-- 自定义样式 -->
  <link rel="stylesheet" href="../styles/route-planning1.css" />
  <link rel="stylesheet" href="./styles/main.css" />
  <!-- 图标库 -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" />
</head>
<body>
  <div id="app">
    <!-- 顶部导航栏 -->
    <nav class="nav-bar">
      <div class="logo">
        <img src="./assets/logo.png" alt="Logo" />
        <span>智慧旅游</span>
      </div>
      <div class="nav-links">
        <a href="../index.html"><i class="fas fa-compass"></i> 智能推荐</a>
        <a href="route-planning.html" class="active"><i class="fas fa-route"></i> 路线规划</a>
        <a href="place-search.html"><i class="fas fa-map-marked-alt"></i> 场所查询</a>
        <a href="diary.html"><i class="fas fa-book"></i> 日记助手</a>
        <a href="social.html"><i class="fas fa-users"></i> 社交圈</a>
        <a href="profile.html"><i class="fas fa-user-circle"></i> 个人中心</a>
      </div>
    </nav>

    <!-- 主内容区域 -->
      <!-- 原有的起点/终点搜索 -->
  <div class="search-bar">
    <div class="input-group">
      <input type="text" id="startInput" placeholder="请输入起点" oninput="searchSuggestions(this.value, 'start')">
      <div id="startSuggestions" class="suggestions-box"></div>
    </div>

    <div class="input-group">
      <input type="text" id="endInput" placeholder="请输入终点" oninput="searchSuggestions(this.value, 'end')">
      <div id="endSuggestions" class="suggestions-box"></div>
    </div>

    <button class="search-btn" onclick="viewNavigation()">查看导航</button>
  </div>

<div class="input-group">
  <input id="posInput"
         placeholder="输入当前位置，如：午门 或 39.914,116.397"
         oninput="setCurrentPos(this.value)">
  <div id="posSuggestions" class="suggestions-box"></div>
</div>

  <!-- 新增：附近地点搜索 -->
  <div class="search-bar" style="margin-top: 20px;">
    <div class="input-group">
      <input type="text" id="nearbyInput" placeholder="搜索附近地点（如：餐厅、酒店）" 
             oninput="searchNearby(this.value)">
      <div id="nearbySuggestions" class="suggestions-box"></div>
    </div>
    <!-- 如果想要加一个“搜索附近”按钮，也可以： -->
    <!-- <button class="search-btn" onclick="searchNearbyButton()">搜索附近</button> -->
  </div>

    <!-- 底部 -->
    <footer class="footer">
      <div class="footer-content">
        <p>&copy; 2024 智慧旅游管理系统</p>
      </div>
    </footer>
  </div>
  <!-- 原生 JavaScript -->

<!-- 在 HTML 最底部加入脚本 -->
<script>
  async function viewNavigation() {
    const start = document.getElementById("startInput").value.trim();
    const end = document.getElementById("endInput").value.trim();

    if (!start || !end) {
      alert("请输入完整的起点和终点");
      return;
    }

    try {
      const res = await fetch("http://localhost:5000/api/generate-map", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ start, end })
      });

      const result = await res.json();
      if (result.status === "success") {
        // 地图生成成功，跳转到 route-planning1.html 展示地图
        window.location.href = "route-planning2.html";
      } else {
        alert("地图生成失败：" + result.message);
      }
    } catch (error) {
      alert("请求失败，请检查 Flask 后端是否已运行");
    }
  }
</script>
<script src="../src/route-planning1.js"></script>
</body>
</html>
